{
  "ticket": "ko-f65e",
  "title": "Consolidate .ko/ top-level files into .ko/config.yaml",
  "questions": [
    {
      "id": "q1",
      "question": "Should we keep backwards compatibility with pipeline.yml?",
      "context": "INVARIANTS.md says 'avoid backwards-compatibility hacks', but this is infrastructure work that could disrupt users mid-development.",
      "options": [
        {
          "label": "Deprecation path (Recommended)",
          "value": "deprecate",
          "description": "FindPipelineConfig tries config.yaml first, falls back to pipeline.yml with a stderr warning. Remove fallback in a future ticket."
        },
        {
          "label": "Hard break",
          "value": "hard_break",
          "description": "Only look for config.yaml. Old pipeline.yml files are ignored immediately."
        },
        {
          "label": "Silent fallback",
          "value": "silent_fallback",
          "description": "Try config.yaml first, fall back to pipeline.yml without warning. No migration pressure."
        }
      ]
    },
    {
      "id": "q2",
      "question": "What happens to the standalone .ko/prefix file for existing projects?",
      "context": "Old projects have .ko/prefix. New projects will write prefix into config.yaml.",
      "options": [
        {
          "label": "Read fallback, write new only (Recommended)",
          "value": "fallback_read",
          "description": "ReadPrefix checks config.yaml first, falls back to .ko/prefix. WritePrefix only writes to config.yaml. Natural migration on next write."
        },
        {
          "label": "Dual write",
          "value": "dual_write",
          "description": "Write prefix to both config.yaml and .ko/prefix for full backwards compat."
        },
        {
          "label": "Hard break",
          "value": "hard_break",
          "description": "Only read/write config.yaml. Old .ko/prefix files are ignored immediately."
        }
      ]
    },
    {
      "id": "q3",
      "question": "Should prefix be writable after init, or set-once?",
      "context": "Currently WritePrefix exists and is called from detectPrefix. But prefix changes are rare and potentially dangerous (breaks existing ticket IDs).",
      "options": [
        {
          "label": "Keep writable (Recommended)",
          "value": "writable",
          "description": "Maintain existing behavior. Read config, update prefix field, write back. Don't optimize for a rare operation."
        },
        {
          "label": "Set-once, warn on change",
          "value": "set_once_warn",
          "description": "Allow writes but emit a warning when changing an existing prefix. Makes the danger visible."
        },
        {
          "label": "Set-once, error on change",
          "value": "set_once_error",
          "description": "Refuse to change prefix after init. Require a --force flag or manual config edit."
        }
      ]
    }
  ]
}
